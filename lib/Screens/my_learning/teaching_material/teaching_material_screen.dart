import 'package:flutter/material.dart';import 'package:provider/provider.dart';import 'package:schoolworkspro_app/Screens/my_learning/teaching_material/teaching_material_view_model.dart';import 'package:url_launcher/url_launcher.dart';import '../../../components/shimmer.dart';import '../../../config/api_response_config.dart';class StudentTeachingMaterialScreen extends StatefulWidget {  final String lessonSlug;  const StudentTeachingMaterialScreen(      {Key? key, required this.lessonSlug})      : super(key: key);  @override  State<StudentTeachingMaterialScreen> createState() =>      _StudentTeachingMaterialScreenState();}class _StudentTeachingMaterialScreenState    extends State<StudentTeachingMaterialScreen> {  late TeachingMaterialViewModel _provider;  @override  void initState() {    WidgetsBinding.instance.addPostFrameCallback((timeStamp) {      _provider = Provider.of<TeachingMaterialViewModel>(context,          listen: false);      // _provider.fetchTeachingMaterials(widget.lessonSlug);      refreshData(_provider);    });    super.initState();  }  Future<void> _launchInBrowser(Uri url) async {    if (!await launchUrl(      url,      mode: LaunchMode.externalApplication,    )) {      throw 'Could not launch $url';    }  }  Future<void> refreshData(TeachingMaterialViewModel provider) async {    provider.fetchTeachingMaterials(widget.lessonSlug);  }  @override  Widget build(BuildContext context) {    return Consumer<TeachingMaterialViewModel>(      builder: (context, value, child) {        return Scaffold(          body: isLoading(value.teachingMaterialApiResponse)              ? VerticalLoader()              : value.materials.files == null                  ? Container()                  : RefreshIndicator(                      onRefresh: () => refreshData(value),                      child: Padding(                        padding: const EdgeInsets.symmetric(                            horizontal: 10, vertical: 15),                        child: ListView.builder(                          shrinkWrap: true,                          physics: const BouncingScrollPhysics(),                          itemBuilder: (context, int index) {                            return Card(                              elevation: 2.0,                              clipBehavior: Clip.antiAlias,                              child: Padding(                                padding: const EdgeInsets.all(10.0),                                child: Row(                                  children: [                                    Text("${index + 1}. "),                                    Expanded(child: InkWell(                                        onTap: () {                                          String url =                                              "https://api.schoolworkspro.com/uploads/files/${value.materials.files![index].filename}";                                          _launchInBrowser(                                              Uri.parse(url));                                        },                                        child: Text(                                          value.materials                                              .files![index].filename                                              .toString(),                                          style: const TextStyle(                                              color:                                                  Colors.blueAccent,                                              fontWeight:                                                  FontWeight.w500),                                        ))),                                    const SizedBox(                                      height: 10,                                    )                                  ],                                ),                              ),                            );                          },                          itemCount:                              value.materials.files?.length,                        ),                      ),                    ),        );      },    );  }}